# 功能規格：計數器前端介面

**功能分支**: `001-counter-frontend`  
**建立日期**: 2025-11-20  
**狀態**: 草稿  
**輸入**: 建構計數器的前端功能  
**設計來源**: [Figma 設計檔案](https://www.figma.com/design/AWdcwmlvvrrjn8t19P0tR7/Untitled?node-id=0-1)  
**詳細設計規格**: [`docs/design-spec-detailed.md`](../../docs/design-spec-detailed.md)

## 使用者情境與測試 *(必填)*

### User Story 1 - 檢視初始計數器 (優先級: P1) 🎯 MVP

使用者開啟 App 時，能夠立即看到一個簡潔美觀的計數器介面，顯示初始數字 0，並理解這是一個計數應用程式。

**為何此優先級**: 這是 MVP 的核心，提供基本的使用者介面和視覺回饋。沒有這個畫面，應用程式無法使用。

**獨立測試**: 可透過啟動應用程式並檢查畫面是否正確顯示來完整測試。提供基本的使用者體驗價值（清楚看到當前計數）。

**驗收情境**:

1. **Given** 使用者首次開啟應用程式，**When** 應用程式載入完成，**Then** 畫面中央顯示白色卡片容器
2. **Given** 應用程式已載入，**When** 使用者查看畫面，**Then** 標題顯示「計數器」文字（16px，Inter Regular）
3. **Given** 應用程式已載入，**When** 使用者查看計數顯示區，**Then** 數字顯示為「0」（72px，Inter Bold）
4. **Given** 應用程式已載入，**When** 使用者查看卡片內部，**Then** 在卡片底部區域顯示深藍色圓形按鈕（64×64px）帶有白色 + 號圖示
5. **Given** 應用程式已載入，**When** 使用者觀察背景，**Then** 背景顯示淺藍色漸層（#EFF5FE → #E0E7FF）
6. **Given** 應用程式已載入，**When** 使用者觀察卡片，**Then** 卡片具有圓角（16px）和雙層陰影效果

---

### User Story 2 - 遞增計數 (優先級: P1) 🎯 MVP

使用者點擊加號按鈕時，計數數字立即增加 1，提供即時的視覺回饋。

**為何此優先級**: 這是應用程式的核心互動功能，與 P1 的視覺呈現同等重要。兩者結合構成完整的 MVP。

**獨立測試**: 可透過點擊按鈕並驗證數字變化來完整測試。提供核心功能價值（計數遞增）。

**驗收情境**:

1. **Given** 計數器顯示 0，**When** 使用者點擊浮動按鈕一次，**Then** 計數顯示更新為 1
2. **Given** 計數器顯示 0，**When** 使用者連續點擊按鈕三次，**Then** 計數顯示更新為 3
3. **Given** 計數器顯示任意數字 N，**When** 使用者點擊按鈕，**Then** 計數顯示更新為 N+1
4. **Given** 使用者點擊按鈕，**When** 畫面更新，**Then** 更新過程流暢無延遲（<100ms）
5. **Given** 使用者點擊按鈕，**When** 數字改變，**Then** 文字大小和樣式保持一致（72px Bold）

---

### User Story 3 - 自動化測試支援 (優先級: P2)

所有 UI 元件都具有唯一的識別符號，方便自動化測試工具精確定位和操作元件。

**為何此優先級**: 雖然不影響終端使用者體驗，但對於開發團隊確保品質和持續整合至關重要。

**獨立測試**: 可透過撰寫 Widget 測試並使用 `find.byKey()` 來驗證所有元件都可被定位。

**驗收情境**:

1. **Given** 自動化測試腳本執行，**When** 測試工具搜尋標題元件，**Then** 可透過 `Key('counter_title')` 精確定位
2. **Given** 自動化測試腳本執行，**When** 測試工具搜尋計數顯示，**Then** 可透過 `Key('counter_display')` 精確定位
3. **Given** 自動化測試腳本執行，**When** 測試工具搜尋加號按鈕，**Then** 可透過 `Key('increment_button')` 精確定位
4. **Given** 自動化測試腳本執行，**When** 測試工具讀取計數值，**Then** 可透過 `semanticsLabel` 取得當前數字
5. **Given** 自動化測試腳本模擬點擊，**When** 觸發按鈕點擊事件，**Then** 計數數字正確遞增

---

### 邊界情況

- **當計數達到極大數字時會發生什麼？** 
  - 數字應繼續增加，文字可能會縮小以適應顯示區域（或使用科學記號）
  - 實務上 Dart 的 `int` 可支援到 2^63-1，足夠使用

- **當使用者快速連點按鈕時會發生什麼？**
  - 每次點擊都應正確註冊並遞增計數
  - UI 更新應保持流暢（60 FPS）
  - 不應出現漏點或重複計數的情況

- **當畫面方向改變時（橫向/直向）會發生什麼？**
  - 卡片容器保持居中
  - 所有元件保持正確的尺寸和間距
  - 背景漸層適應新的螢幕尺寸

- **當使用者切換深色/淺色主題時會發生什麼？**
  - 目前設計為固定配色方案
  - 未來可擴充支援系統主題切換

## 功能需求 *(必填)*

### 功能需求清單

#### 核心功能

- **FR-001**: 應用程式啟動時，系統**必須 (MUST)** 顯示初始計數值為 0
- **FR-002**: 系統**必須 (MUST)** 在畫面中央顯示一個白色卡片容器（320×372px）
- **FR-003**: 系統**必須 (MUST)** 在卡片頂部顯示標題文字「計數器」
- **FR-004**: 系統**必須 (MUST)** 在卡片中央顯示當前計數數字
- **FR-005**: 系統**必須 (MUST)** 在卡片內部底部區域顯示一個圓形按鈕（64×64px），按鈕應放在 Card 元件的 Column 內，而非使用 Scaffold.floatingActionButton
- **FR-006**: 使用者點擊按鈕時，系統**必須 (MUST)** 將計數值遞增 1
- **FR-007**: 計數值更新後，系統**必須 (MUST)** 立即反映在 UI 上（<100ms）

#### 視覺規格

- **FR-008**: 背景**必須 (MUST)** 使用淺藍色漸層（從 #EFF5FE 到 #E0E7FF，左上到右下）
- **FR-009**: 卡片容器**必須 (MUST)** 使用白色背景（#FFFFFF）
- **FR-010**: 卡片**必須 (MUST)** 具有 16px 圓角
- **FR-011**: 卡片**必須 (MUST)** 顯示雙層陰影效果（參考設計規格）
- **FR-012**: 標題文字**必須 (MUST)** 使用 Inter Regular 16px，顏色 #364153
- **FR-013**: 計數數字**必須 (MUST)** 使用 Inter Bold 72px，顏色 #101828
- **FR-014**: 圓形按鈕**必須 (MUST)** 使用深藍色背景（#030213）
- **FR-015**: 圓形按鈕**必須 (MUST)** 顯示白色 + 號圖示（#FFFFFF）
- **FR-016**: 圓形按鈕**必須 (MUST)** 為完全圓形（64×64px，使用 BoxShape.circle 確保完美圓形）
- **FR-017**: 圓形按鈕**必須 (MUST)** 具有雙層陰影效果（參考設計規格）
- **FR-017A**: 標題與計數數字之間**必須 (MUST)** 有足夠間距（≥ 24px），避免視覺擁擠
- **FR-017B**: 計數數字與按鈕之間**必須 (MUST)** 有足夠間距（≥ 24px），確保清晰的視覺層次

#### 可存取性與測試

- **FR-018**: 標題元件**必須 (MUST)** 具有唯一識別符號 `Key('counter_title')`
- **FR-019**: 計數顯示元件**必須 (MUST)** 具有唯一識別符號 `Key('counter_display')`
- **FR-020**: 圓形按鈕**必須 (MUST)** 具有唯一識別符號 `Key('increment_button')`
- **FR-021**: 計數顯示**必須 (MUST)** 包含語義標籤（semanticsLabel）以支援螢幕閱讀器
- **FR-022**: 圓形按鈕**必須 (MUST)** 包含工具提示（tooltip）說明其功能

#### 效能需求

- **FR-023**: 應用程式冷啟動至首個畫面**必須 (MUST)** 在 3 秒內完成（中階裝置）
- **FR-024**: 按鈕點擊後 UI 更新**必須 (MUST)** 在 100ms 內完成
- **FR-025**: 畫面更新**必須 (MUST)** 維持 60 FPS 的流暢度
- **FR-026**: 快速連續點擊（10次/秒）時，所有點擊**必須 (MUST)** 正確註冊

#### 程式碼品質

- **FR-027**: 所有程式碼**必須 (MUST)** 通過 `flutter analyze` 零錯誤零警告
- **FR-028**: 所有公開 API 和元件**必須 (MUST)** 包含 Dart 文件註解
- **FR-029**: Widget 測試覆蓋率**必須 (MUST)** 達到 60% 以上
- **FR-030**: 業務邏輯（State Management）測試覆蓋率**必須 (MUST)** 達到 80% 以上

### 關鍵實體 *(此功能涉及的資料)*

- **Counter State（計數器狀態）**: 
  - 代表當前的計數值
  - 屬性: `count` (整數，預設值 0)
  - 行為: 遞增計數
  - 生命週期: 應用程式執行期間持續存在，關閉後不保留

- **CounterPage（計數器頁面）**:
  - 代表計數器的視覺呈現
  - 包含: 標題、計數顯示、圓形按鈕（位於卡片內部）
  - 關聯: 監聽並顯示 Counter State 的變化

## 成功標準 *(必填)*

### 可量測成果

#### 使用者體驗指標

- **SC-001**: 使用者開啟應用程式後，**3 秒內**可看到完整載入的計數器介面（中階裝置）
- **SC-002**: 使用者點擊按鈕後，計數數字在 **100 毫秒內**完成更新
- **SC-003**: 使用者連續點擊按鈕 10 次，**100% 的點擊**都正確註冊並反映在計數上
- **SC-004**: 應用程式在執行期間維持 **60 FPS** 的流暢畫面更新（無掉幀）
- **SC-005**: **100% 的測試使用者**能在首次使用時立即理解如何操作計數器（點擊按鈕增加數字）

#### 視覺一致性指標

- **SC-006**: 實作的畫面與 Figma 設計稿的視覺差異 **< 5%**（顏色、尺寸、間距）
- **SC-007**: 所有顏色值與設計規格完全一致（**100% 匹配**）
- **SC-008**: 所有文字樣式（字體、大小、粗細）與設計規格完全一致（**100% 匹配**）
- **SC-009**: 卡片陰影效果與設計規格視覺上一致（**通過視覺回歸測試**）
- **SC-010**: 在 iPhone 14 Pro、Pixel 7、iPad 上顯示正確且居中（**3/3 裝置通過**）

#### 品質與測試指標

- **SC-011**: Widget 測試覆蓋率達到 **最低 60%**
- **SC-012**: 業務邏輯測試覆蓋率達到 **最低 80%**
- **SC-013**: 所有測試通過率 **100%**（零失敗測試）
- **SC-014**: 靜態分析 `flutter analyze` 結果：**零錯誤、零警告**
- **SC-015**: 所有 UI 元件可透過自動化測試工具定位（**100% 可定位率**）
- **SC-016**: 整合測試模擬「開啟 App → 點擊三次 → 驗證顯示 3」完全自動化通過

#### 可存取性指標

- **SC-017**: 所有互動元件都有語義標籤，螢幕閱讀器可正確讀取（**100% 覆蓋**）
- **SC-018**: 按鈕具有描述性工具提示（**100% 覆蓋**）
- **SC-019**: 顏色對比度符合 WCAG AA 標準（**最低 4.5:1 對比度**）

#### 效能指標

- **SC-020**: 應用程式峰值記憶體使用量 **< 50MB**（不含系統開銷）
- **SC-021**: 在低階裝置（2GB RAM）上冷啟動時間 **< 5 秒**
- **SC-022**: 快速連續點擊（每秒 20 次）時，CPU 使用率保持 **< 30%**

#### 程式碼品質指標

- **SC-023**: 所有公開 API 具有完整的 Dart 文件註解（**100% 覆蓋**）
- **SC-024**: 程式碼遵循 Flutter 官方風格指南（**通過 `dart format` 檢查**）
- **SC-025**: 沒有程式碼異味（無過長函式、無深層巢狀、無魔術數字）（**通過程式碼審查**）

---

## 附錄：設計資源參考

### Figma 設計檔案

- **連結**: [https://www.figma.com/design/AWdcwmlvvrrjn8t19P0tR7/Untitled?node-id=0-1](https://www.figma.com/design/AWdcwmlvvrrjn8t19P0tR7/Untitled?node-id=0-1)
- **詳細規格**: [`docs/design-spec-detailed.md`](../../docs/design-spec-detailed.md)
- **提取的設計資源**: `design-assets/` 資料夾
- **設計規格 JSON**: `docs/design-spec.json`

### 關鍵設計參數快速參考

| 參數類別 | 數值 | 說明 |
|---------|------|------|
| **卡片尺寸** | 320×372px | 主要內容容器 |
| **圓角** | 16px | 卡片圓角 |
| **按鈕尺寸** | 64×64px | 圓形浮動按鈕 |
| **標題字體** | Inter Regular 16px | 顏色 #364153 |
| **數字字體** | Inter Bold 72px | 顏色 #101828 |
| **按鈕顏色** | #030213 | 深藍色 |
| **背景漸層** | #EFF5FE → #E0E7FF | 淺藍色漸層 |

### 測試場景對照表

| 驗收標準 | 對應測試類型 | 測試重點 |
|---------|------------|----------|
| 開啟 App 顯示 0 | Widget Test | 初始狀態驗證 |
| 連按三次顯示 3 | Integration Test | 互動流程驗證 |
| UI 元件可定位 | Widget Test | Key/Semantics 驗證 |
| 視覺一致性 | Golden Test | 截圖對比 |
| 效能指標 | Performance Test | FPS/記憶體監控 |

---

**規格版本**: 1.0  
**最後更新**: 2025-11-20  
**下一步**: 執行 `/speckit.clarify` 或 `/speckit.plan` 繼續開發流程
